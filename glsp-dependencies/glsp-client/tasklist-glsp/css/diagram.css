/********************************************************************************
 * Copyright (c) 2022 EclipseSource and others.
 *
 * This program and the accompanying materials are made available under the
 * terms of the Eclipse Public License v. 2.0 which is available at
 * http://www.eclipse.org/legal/epl-2.0.
 *
 * This Source Code may also be made available under the following Secondary
 * Licenses when the conditions for such availability set forth in the Eclipse
 * Public License v. 2.0 are satisfied: 
 * -- GNU General Public License, version 2 with the GNU Classpath Exception
 * which is available at https://www.gnu.org/software/classpath/license.html
 * -- MIT License which is available at https://opensource.org/license/mit.
 *
 * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0 OR MIT
 ********************************************************************************/


/* 
   Palette & Base
    */



:root{
  --c-root:  hsl(170, 55%, 50%);
  --c-mand:  hsla(1, 90%, 32%, 0.928);
  --c-opt:   hsl(261, 63%, 42%);
  --stroke:      hsl(220 15% 35%);
  --stroke-sel:  hsl(220 20% 20%);
  --text:        hsl(220 20% 18%);
  --text-on:     #fff;
  --shadow:      0 1px 2px rgba(0,0,0,.18), 0 3px 8px rgba(0,0,0,.08);
}


svg {
  border-style: solid;
  border-width: 1px;
  border-color: #bbb;
}

.sprotty-node {
  fill: inherit;
}




/* 
   ROOT FEATURE
*/
.feature-node-root{
  clip-path: None;
  --node-fill: var(--c-root);
  cursor: default;
}

.feature-node-root :is(rect, path, polygon){
  fill: var(--node-fill);
  stroke: var(--stroke);
  stroke-width: 1.25;
  filter: drop-shadow(var(--shadow));
  transition: filter .15s ease, stroke-width .15s ease, transform .05s ease;
}

.feature-node-root rect{ rx:0; ry:0; }


.sprotty-node.feature-node-root.sprotty-hover    rect{ filter: drop-shadow(0 2px 6px rgba(0,0,0,.22)); stroke-width: 2; }
.sprotty-node.feature-node-root.sprotty-selected rect{ stroke: var(--stroke-sel); stroke-width: 2.5; }


.feature-node-root .labels,
.feature-node-root .labels text,
.feature-node-root .sprotty-label text{
  fill: var(--text-on);
  font-weight: 600;
  letter-spacing: .2px;
  dominant-baseline: middle;
  paint-order: stroke fill;          
  stroke: rgba(0,0,0,.35);
  stroke-width: 2px;
  text-shadow: 0 1px 0 rgba(0,0,0,.25);
}




/* 
   OBLIGATORY FEATURE
*/
.feature-node-obligatory{
  clip-path: None;
  --node-fill: var(--c-mand);
  cursor: default;
}
.feature-node-obligatory :is(rect, path, polygon){
  fill: var(--node-fill);
  stroke: var(--stroke);
  stroke-width: 1.25;
  filter: drop-shadow(var(--shadow));
  transition: filter .15s ease, stroke-width .15s ease, transform .05s ease;
}
.feature-node-obligatory rect{ rx:0; ry:0; }

.sprotty-node.feature-node-obligatory.sprotty-hover    rect{ filter: drop-shadow(0 2px 6px rgba(0,0,0,.22)); stroke-width: 2; }
.sprotty-node.feature-node-obligatory.sprotty-selected rect{ stroke: var(--stroke-sel); stroke-width: 2.5; }

.feature-node-obligatory .labels,
.feature-node-obligatory .labels text,
.feature-node-obligatory .sprotty-label text{
  fill: var(--text-on);
  font-weight: 600;
  letter-spacing: .2px;
  dominant-baseline: middle;
  paint-order: stroke fill;
  stroke: rgba(0,0,0,.35);
  stroke-width: 2px;
  text-shadow: 0 1px 0 rgba(0,0,0,.25);
}
/* ===== Feature marker (small circle above the label) ===== */

/* tiny gap above the label */
.feature-marker { 
  transform: translateY(2px);
}

/* common styling (covers class on wrapper or on the shape itself) */
.feature-marker circle,
.feature-marker ellipse,
.feature-marker,
.feature-marker-optional,
.feature-marker-mandatory {
  pointer-events: none;
  filter: drop-shadow(var(--shadow));
  transition: transform .05s ease;
}

/* fallback radius in case size doesn't propagate */
.feature-marker circle { r: 6; }

/* Optional = filled dot */
.feature-marker-optional,
.feature-marker-optional circle,
.feature-marker-optional ellipse {
  fill: var(--text-on);
  stroke: var(--text-on);
  stroke-width: 2px;
}

/* Mandatory/root = hollow dot */
.feature-marker-mandatory,
.feature-marker-mandatory circle,
.feature-marker-mandatory ellipse {
  fill: none;
  stroke: var(--text-on);
  stroke-width: 2px;
}





/* 
   OPTIONAL FEATURE
*/
.feature-node-optional{
  clip-path: None;
  --node-fill: var(--c-opt);
  cursor: default;
}
.feature-node-optional :is(rect, path, polygon){
  fill: var(--node-fill);
  stroke: var(--stroke);
  stroke-width: 1.25;
  filter: drop-shadow(var(--shadow));
  transition: filter .15s ease, stroke-width .15s ease, transform .05s ease;
}
.feature-node-optional rect{ rx:0; ry:0; }

.sprotty-node.feature-node-optional.sprotty-hover    rect{ filter: drop-shadow(0 2px 6px rgba(0,0,0,.22)); stroke-width: 2; }
.sprotty-node.feature-node-optional.sprotty-selected rect{ stroke: var(--stroke-sel); stroke-width: 2.5; }

.feature-node-optional .labels,
.feature-node-optional .labels text,
.feature-node-optional .sprotty-label text{
  fill: var(--text-on);
  font-weight: 600;
  letter-spacing: .2px;
  dominant-baseline: middle;
  paint-order: stroke fill;
  stroke: rgba(0,0,0,.35);
  stroke-width: 2px;
  text-shadow: 0 1px 0 rgba(0,0,0,.25);
}



/* .labels */
.labels,
.labels text,
.sprotty-label text{
  fill: var(--text);                 
  font-weight: 600;
  letter-spacing: .2px;
  dominant-baseline: middle;
  paint-order: stroke fill;
  stroke: rgba(0,0,0,.28);
  stroke-width: 2px;
  text-shadow: 0 1px 0 rgba(0,0,0,.20);
}

/* ===== Feature marker (robust) ===== */
.feature-marker { transform: translateY(2px); }

/* style the actual drawn element, wherever the class ends up */
.feature-marker circle,
.feature-marker ellipse,
.feature-marker-optional circle,
.feature-marker-optional ellipse,
.feature-marker-mandatory circle,
.feature-marker-mandatory ellipse {
  pointer-events: none;
  filter: drop-shadow(var(--shadow));
  stroke-width: 2px;
  vector-effect: non-scaling-stroke;
}

/* Optional = filled dot */
.feature-marker-optional,
.feature-marker-optional circle,
.feature-marker-optional ellipse {
  fill: var(--text-on);
  stroke: var(--text-on);
}

/* Mandatory/root = hollow dot */
.feature-marker-mandatory,
.feature-marker-mandatory circle,
.feature-marker-mandatory ellipse {
  fill: none;
  stroke: var(--text-on);
}

/* safety net if renderer didnâ€™t compute radius from size */
.feature-marker circle { r: 7; }
